parameters:
  relative_directory: ''

steps:
  # Install any pods necessary for the project
  - bash: |
      echo "pod install"
      pod install
    workingDirectory: apps/fluent-tester/${{ parameters.relative_directory }}
    displayName: 'pod install ${{ parameters.relative_directory }}'

  - bash: |
      echo "Pre boot simulator"
      UDID=$(xcrun simctl create test-iphone com.apple.CoreSimulator.SimDeviceType.iPhone-12 iOS15)
      xcrun simctl boot $UDID
    workingDirectory: apps/${{ parameters.relative_directory }}
    displayName: 'Boot simulator'

  - bash: |
      echo "yarn ${{ parameters.relative_directory }}"
      yarn ${{ parameters.relative_directory }}
    workingDirectory: apps/fluent-tester
    displayName: 'yarn ${{ parameters.relative_directory }}'
    env:
      platform_directory: ${{ parameters.relative_directory }}
